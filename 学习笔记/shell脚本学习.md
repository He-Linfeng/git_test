# Shell脚本

## shell解析器

    echo $SHELL  #sh,ash,bash

## 两个特殊文件

    /etc/profile
    此文件为系统的每个用户设置环境信息,当用户第一次登录时,该文件被执行，系统的公共环境变量在这里设置开始自启动的程序，一般也在这里设置

    ～/.bashrc
    用户自己家目录中的.bashrc
    登陆时会自动调用，打开任意终端时也会自动调用，一般设置与个人用户有关的环境变量，如交叉编译器的路径等等

## shell语法

    1. 开头定义： #!/bin/bash
        #!用来声明脚本由什么shell解析，否则使用默认shell

    2. 添加权限：chmod +x xx.sh
        shell脚本文件需要有可执行的权限

    3. 运行方式：./xx.sh, bash xx.sh, xx.sh
        ./xx.sh:先按照文件中#!指定的解析器解析，如果不存在，使用默认解析器
    
    4. 添加注释：#xx
    	在shell脚本中使用#来对文字进行注释

## 变量

    1. 变量定义
        变量名=变量值 如：num=10
    2. 变量引用
        $变量名 如：$num
    3. 清除变量
        unset 变量名 如：unset num
    4. 读取变量
        read 变量名 如：read num
    5. 添加提示
        read -p "提示" 变量名 如：read -p "请输入num的值" num
    6. 多个变量
        read 变量1 变量2 如：read num1 num2
    7. 变量只读 
        readonly 变量 如readonly num=10
    8. 环境变量
        env
        如果要在PATH变量中追加一个路径： export PATH=$PATH:/需要添加的路径
    9. 导出环境变量
        source 脚本文件 或 . 脚本文件 如：source make.sh 或 . make.sh
    10. 注意事项
        * 变量名只能以英文字母下划线开头，不能以数字开头
        * 等号两边不能直接接空格，如果变量中本身包含了空格，则需要使用双引号或单引号括起来
        * 双引号可以解析变量的值，单引号不能解析变量的值
    11. 预设变量
        * $#：传给shell脚本参数的数量
        * $*：传给shell脚本参数的内容
        * $$：当前进程的进程号
        * $0：当前执行的进程名
        * $1、$2：运行脚本时传递给脚本的参数，用空格隔开
        * $?：用于检查上一个命令执行是否正确（正确返回0）
    12. 字符串变量
        假设 str="hehe:haha:xixi:lala"
        ${#字符串变量} 得到字符串长度 如 ${#str}  19
        ${字符串变量:3}  从下标3开始提取 如 ${str:3} e:haha:xixi:lala
        ${字符串变量:3:6}  从下标3提取6个字节 如 ${str:3:6} e:haha
        ${字符串变量/old/new} 用new替换str中出现的第一个old 如 ${str/:/#} hehe#haha:xixi:lala
        ${字符串变量//old/new} 用new替换str中所有的old 如 ${str//:/#} hehe#haha#xixi#lala
    13. 常见符号
        * 双引号（""）：包含的变量会被解释成变量值
        * 单引号（''）：包含的变量会当作字符串解释
        * 反引号（``）：反引号中的内容作为系统命令，并执行其内容
        * 反斜杠（\ ）：同c语言中的\n\t\r\a等，echo命令需要-e转义
        * 小括号（()）：括号中内容由子shell来完成，不影响当前shell中的变量
        * 大括号（{}）：括号中内容由当前shell执行，会影响当前变量
    14. 变量判断
        ${变量:-值} 如：${num:-100} 如果num存在，则表达式的值为num，否则为100
        ${变量:=值} 如：${num:=100} 如果num存在，则表达式的值为num，否则为100,且num赋值为100
    
## 判断
    test命令 或 []
    1. 文件判断
        -e 是否存在 如 test -e $fileName 或 [ -e $fileName ]
        -d 是否是目录
        -f 是否是文件
        -r 是否可读
        -w 是否可写
        -x 是否可执行
        -L 符号链接
        -c 是否是字符设备
        -b 是否是块设备
        -s 是否非空
    2. 字符串判断
        = 两个字符串是否相等 如： test $str1 = $str2 或 [ $str1 = $str2 ]
        != 两个字符串是否不等
        -z 是否是空串
        -n 是否是非空串
    3. 数值测试
        -eq 数值是否相等 如：test $num1 -eq $num2 或 [ $num1 -eq $num2 ]
        -ne 数值是否不相等
        -gt 数1是否大于数2
        -ge 数1是否大于等于数2
        -le 数1是否小于等于数2
        -lt 数1是否小于数2
    4. 命令判断
        && 命令1&&命令2 命令1成功执行（返回0）才执行命令2
        || 命令1||命令2 命令1未成功执行（返回非0）才执行命令2
        -a 两种状况同时成立 如： test -r file -a -x file 同时具有r和x，返回true
        -o 两种状况任何一个成立 如： test -r file -o -x file 具有r或x，返回true
        !  相反状态 如： test ! -x file 不具有x，返回ture

## 语句
    1. if语句（一个判断）
        if [条件1]; then
            程序1
        else 
            程序2
        fi
    2. if语句（多个判断）
        if [条件1]; then
            程序1
        elif
            程序2
        else 
            程序3
        fi
    3. case语句
        case $变量名 in
            情况1|情况2|情况3)
            程序1
            ;;
            情况4|情况5|情况6)
            程序2
            ;;
            情况7|情况8)
            程序3
            ;;
            *)
            程序4
            ;;
        esac
    4. for语句
        for((初始值; 限制值; 执行步阶))
        do
            程序
        done
    5. for语句2
        for 变量名 in 值1 值2 值3...
        do
            程序
        done
    6. whle语句
        while [条件]
        do 
            程序
        done
    7. until语句
        until [条件]
        do 
            程序
        done
        #直到符合条件才停止循环

## 函数
    1.函数格式
        function 函数名
        {
            程序
        }
    2. 调用函数
        函数名 参数1 参数2 ...
    3. 返回值
        return 0 无错误返回
        return 1 有错误返回
        return 用最后状态命令决定返回值
    4. 在a.sh中调用b.sh中函数
        source b.sh

## 常用关键字
    1. declare
        可以用来声明shell变量、设置变量的属性，也可以写作typeset。
        例如使用 declare -i s 代表强制把s变量当作int型参数运算